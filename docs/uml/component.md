---
title: 构件图 Component
date: 2020-07-20
tags:
 - 构件图
 - UML

---

构件图属于静态建模，主要用于描述各个构件之间的关系，它为我们在上帝视角设计系统和整理系统构成提供了有力的帮助。构件图明确了系统的主要枝干和脉路，能够让我们在程序设计阶段中发现并处理不同模块、不同包、不同子系统之间的耦合问题，同时也能够帮助我们发现构件的可复用性，提高开发效率。



## 构件图的表示

不同版本的 UML 规范中有不同的构件表示，但总体朝着简化的目的演进，以下是计算器构件图的具体表示。

![image-20200720125531394](http://can.sfhfpc.com/uPic/image-20200720125531394.png)

左侧的是旧版本的构件图表示，右侧的是新版本的构件图表示。右侧构件图中还增加了构件包含的几个函数，如上图所示的加、减、乘、除函数。相比之下，右侧的更容易看懂一些。

::: tip

右侧的构件图中的 Tool 和双冒号表示这个构件属于 Tool 包。

:::



### 构件的接口表示

构件与构件之间的接口有两种表示方式，一种是用虚线的空心箭头进行关联，接口以矩形来表示；另一种则是用实线进行关联，接口以圆圈来表示。具体如下图所示。

![image-20200720130317152](http://can.sfhfpc.com/uPic/image-20200720130317152.png)

### 构件的依赖关系

上图表示的是构件与构件之间的接口，是实现关系，实际上构件和接口之间还存在着依赖关系。那如何表示它们的实现关系和依赖关系呢？由于实现关系有两种表示，所以依赖关系也有两种表示。权衡左右我决定只写相对简单且美观的那种，另一种可以丢弃了，具体表示如下图所示。

![image-20200720131145420](http://can.sfhfpc.com/uPic/image-20200720131145420.png)

实现与依赖用圆圈和半圆弧表示，圆圈一侧表示实现关系，半圆弧一侧表示依赖关系。如果你是一名 WEB 开发工程师，你应该能想象到 Handler 模块中的计算器构件依赖于 Tool 包中的计算器构件，它们之间的羁绊就是这个名为 Key 的接口（其实换一个名称也可以，说不定还更容易理解）。



## 实战 电商购物构件图

大家应该都知道电商购物的流程，首先挑选商品，选到心仪的商品就添加到购物车。商品挑完后前往结算，接着核对自己的地址信息并提交订单。订单提交后网页跳转到支付页面，我们选择合适的支付方式付款即可。以京东商城为例，具体购物流程如下面几幅图所示。

![image-20200720133204129](http://can.sfhfpc.com/uPic/image-20200720133204129.png)

![image-20200720133138539](http://can.sfhfpc.com/uPic/image-20200720133138539.png)

![image-20200720133253794](http://can.sfhfpc.com/uPic/image-20200720133253794.png)

![image-20200720133434691](http://can.sfhfpc.com/uPic/image-20200720133434691.png)

如果要用构件图来表示，那怎么画呢？

在开始画之前我们先来捋一捋。从系统设计的角度来看，在画图的时候还需要把库存构件考虑在内。那么就得到购物车构件、订单构件、支付构件和库存构件，具体表示如下图所示。

![image-20200720135013161](http://can.sfhfpc.com/uPic/image-20200720135013161.png)

购物车和订单之间应该有一个结算接口。从两个构件的实际关系来看，订单构件依赖于结算接口，由此可绘制出下图。

![image-20200720140042622](http://can.sfhfpc.com/uPic/image-20200720140042622.png)

结算构件与结算接口为实现关系，订单构件与结算接口为依赖关系，即订单的生成取决于用户结算时的选择。接下来进入到支付环节，支付构件是支付接口的实现，库存构件与支付接口为依赖关系，即库存是否扣减取决于支付的成败，具体表示如下。

![image-20200720141103830](http://can.sfhfpc.com/uPic/image-20200720141103830.png)

购物车和结算之前应该有一个购物车接口，购物车构件和购物车接口是实现关系，结算构件和购物车是依赖关系，即结算的信息取决于用户添加到购物车里的商品，具体表示如下。

![image-20200720141428216](http://can.sfhfpc.com/uPic/image-20200720141428216.png)



现在看看这几个构件如何关联到一起，到目前为止还没有关联起来的是订单构件和支付构件。看上去支付构件依赖于订单接口，订单构件与订单接口是实现关系，具体表示如下。

![image-20200720141631399](http://can.sfhfpc.com/uPic/image-20200720141631399.png)

::: warning

在理解构件图的过程中，我翻阅了相关书籍和网上公开的博文，但都没有找到一个很明确的构件依赖关系说明场景。阅读了例如酒店预定场景和商品购买场景的构件图绘制分析，但总觉得好像不太对。本小节电商购物构件图基于上面两个小节（构件的接口表示和构件的依赖关系）以及实际场景分析推导而来。我对于构件图理解不深，不保证本小节实战分析完全正确，但一路分析下来，我认为是没有错的。

:::

