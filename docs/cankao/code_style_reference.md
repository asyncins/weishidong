---
title: Python 开发团队编码规范参考
sidebar: 'auto'
date: 2021-02-05
tags:
- Python 编程参考

categories:
 - 编程参考
---

> 使用快捷键 Ctrl+D 或 Command+D 可快速收藏本技术专栏 收获爬虫架构/爬虫逆向/存储引擎/消息队列/Python/Golang相关知识



单纯依靠 PEP8 作为团队的编程风格指南是不切实际的，除了代码格式和注释风格之外，还有一些其他内容需要统一，例如环境版本、资源竞争处理、开源库的使用等。因为团队的水平存在差异，你认为正确的做法有可能别人并不认同，所以需要梳理出一份统一的规则作为大家开发时的参照。

具体的编码规范**落地实施**实际上是在**代码评审**和**上线申请环节**，因为只有在那里才会真正进行检查。这里要做的就是罗列出来，统一遵守。


## 命名要求


- [x] 变量名采用小写蛇形风格，例如 coupon_name、 user_last_name 等；
- [x] 常量名采用大写蛇形风格，例如 COUPON_NAME、 USER_LAST_NAME 等；
- [x] 函数名采用小写蛇形风格，并要求以动词开头，例如 take_last_name、 translate 等；
- [x] 类名采用大驼峰命名风格，例如 Storage、 ImageDownload 等；
- [x] 接口名采用大驼峰命名风格，例如 StorageInterface、 DownloadInterface 等；
- [x] 包名采用小写蛇形命名风格，例如 file_storage、 components 等；
- [x] 文件名采用小写蛇形命名风格，例如 urils.py、 remote_cache.conf 等；
- [x] 项目名采用小写蛇形命名风格，例如 sequence、 translation_machine 等；
- [x] 见名知意，要用完整词组表达含义，但词组单词数量不可超过 5 个；
- [x] 不可自定义单词简写，例如  translate  简写为  trans;
- [x] 不可使用语言或系统保留关键词，例如 def、 pass、 class、 id 等；
- [x] 如无特殊情况，不建议使用拼音；



具体细节和示例详见本书（《Python 编程参考》）的**命名选择与风格指南**。


## 注释要求


- [x] 文件注释仅用于描述与文件内容相关的信息，禁止添加例如作者、编写时间等个人信息；
- [x] 变量和常量不应有针对名称的注释；
- [x] 函数必须以多行注释说明函数用途，包括参数含义和返回值含义；
- [x] 逻辑说明或特殊内容说使用单行注释；
- [x] 函数必须使用类型注释，包括参数类型注释和返回对象类型注释；
- [x] 函数调用者必须按照函数类型注释传递符合类型的参数；
- [x] 函数编写者必须按照返回值类型注释返回对象；



有一些经验丰富的开发者可能会对这项（**函数必须以多行注释说明函数用途，包括参数含义和返回值含义**）有疑问，如果命名做的够好、代码设计得够好，实际上不用增加多行注释，现在增加反而显得臃肿。这里考虑的是**团队水平存在差异的情况**，大多数团队都是较少的老手和较多的新手组成，实际编写代码时候**要求新手写出老手的代码是不切实际的**。另外，注释在代码**评审环节有很大的用途**。**代码评审**不仅要看**代码是否符合规范**，还要看**代码功能是否正确**，明明功能需求要向东，代码却向南，没有注释的话，很容易忽略掉这些隐藏的问题。


具体细节和示例详见本书（《Python 编程参考》）的**注释指南**。


## 开发环境要求


- [x] 要求每个项目使用单独的虚拟环境；
- [x] 如无特殊需求，统一使用 Python3.6，若要使用其它版本，请向上级申请；
- [x] 环境依赖跟随项目，以 `pip freeze > require.txt` 命令导出环境依赖；



至于具体使用哪个 Python 版本，依照团队需求和习惯而定。版本太新容易出现库的兼容问题，版本过低则会缺失一些优秀功能特性，因此在选择版本的时候建议选择经过时间验证过的版本。


## 编码要求


- [x] 严格遵守 Python 官方编程风格指南[《Style Guide for Python Code》](https://www.python.org/dev/peps/pep-0008/)的建议；
- [x] 函数应当符合单一职责原则，即一个函数仅做一件事；
- [x] 类或函数应当符合开放封闭原则，对扩展开放、对修改封闭；
- [x] 类或函数应当符合依赖倒置原则，高底层之间互相依赖抽象；
- [x] 避免使用生僻且难以理解的代码写法，例如 `lambda map filter` 组合；
- [x] 有可能因为数量增长造成开销持续增大的操作应当池化，例如数据库连接、多线程、多进程；
- [x] 不使用不了解的算法；



关于单一职责原则、开放封闭原则和依赖倒置等原则细节和示例详见本书（《Python 编程参考》）的**如何设计并写出“好”的代码**。



## 异常处理


- [x] 尽量捕获明确的异常，而不是用 Exception 捕获所有异常；
- [x] try except 包裹尽量少的代码，避免因为包裹太多代码而忽略真正的问题；
- [x] try except 后可以用 else 保证代码按正常逻辑执行；
- [x] 如果涉及资源使用，应当在 try except 后用 finally 释放资源；
- [x] 异常和错误应当持久化记录；




## 资源竞争


- [x] 能用原子性解决的不用锁；
- [x] 加锁和释放锁必须成对出现，避免因为运行异常或者控制流语句导致死锁；
- [x] 并发编程常见的问题就是资源竞争，因此在使用多线程、多进程编写代码时在测试的时候务必留心；






## 开源库


- [x] 不使用不熟悉的开源库；
- [x] 不使用没有得到完整授权的开源库；
- [x] 开源库的使用需经过会议评审，评审内容包括稳定性、有效性、开源协议、适用性、可维护性；




## 项目上线要求


具体详见本书（《Python 编程参考》）的**项目上线流程指引与落地实施**

<Vssue :title="$title" />