---
title: 协作图 communication
date: 2020-07-20
tags:
 - 协作图
 - UML
 - 流程图

---

协作图是我们在程序设计中经常用到的一种图，它跟我们平时说的流程图很相似，主要稍微调整一些画图细节就可以把协作图转为流程图。协作图主要用于组织功能和模块，清晰地描述不同组件之间协作时的关系和顺序。

在后续的内容中，我会将协作图与流程图放到一起来讨论，例如它们实现同一种描述时的画法以及细微差异。



## 协作图的表示

组成协作图的图形元素有四类，矩形、文字、线和箭头，其中箭头又分为实线箭头和虚线箭头。一个简单的协作图如下图所示。

![image-20200719192913063](http://can.sfhfpc.com/uPic/image-20200719192913063.png)

三个矩形代表着三个对象，对象的名字可以随便起，格式也可以随意，并没有特殊约定。对象之间的关联用线表示，而消息的传递则用箭头表示。消息发送的顺序则通过带数字的文字注释来标注。要注意的是，上图并没有虚线箭头，不过根据之前所学，你应该能想到用虚线箭头作为消息回复的表示。



## 图的共通和转换

这个流程你是不是感觉似曾相似，好像在哪里见过？没错，这跟之前我们在时序图中通过车钥匙上锁解锁的场景很像，图也很像，只不过这里以组织的角度来表示，而之前是以时序的角度来表示。也就是说协作图可以转换为流程图，也可以转换为时序图。

流程图是一种没有特定约束的图，各个工程师风格自成一派，互相之间能够看懂即可。相对于协作图来说，表达相同的情况下流程图比协作图简洁多了。流程图可以省下对象之间的线，用箭头表示消息的传递，就像下面这张图。

![image-20200719194145576](http://can.sfhfpc.com/uPic/image-20200719194145576.png)

在简单的关系结构中，甚至可以省去文字前的序号，只保留起始消息传递的序号即可。但复杂一些的场景却不行，例如多对多的调用和异步操作等。有了之前的学习经验，我们可以轻松地用时序图来描述这个过程，具体如下图所示。

![image-20200719195106706](http://can.sfhfpc.com/uPic/image-20200719195106706.png)

嗯，没错。协作图应该是 UML 系列中相对简单易懂的一种图，学起来一点阻碍都没有。

## 状态的表示

有时候我们需要在图中描述某个对象的状态切换，例如空调的开状态和关状态。在协作图中状态的变化需要单独表示，就像下面这幅图所展示的那样。

![image-20200719200057181](http://can.sfhfpc.com/uPic/image-20200719200057181.png)

左侧为协作图的表示，右侧为流程图的表示。这么对比一看，还是流程图更简洁易懂，表达清晰到位。



## 如何表示多个对象

实际工作场景中有很多一对多或者多对多的情况，这时候我们需要知道如何表达多个对象，尤其是多个相同的对象。

![image-20200719201422610](http://can.sfhfpc.com/uPic/image-20200719201422610.png)

协作图和流程图表达多个对象的方式都是重叠，通常以 3 层重叠表示多个对象。



## 主动对象和并发

在图书馆的工作场景中，图书管理员从顾客那里获得想要看的书单，然后分配一名或多名图书查找员去找书。这里的图书管理员称为主动对象，多个图书查找员同时去找书的行为称为并发。

在 UML 中，主动对象需要以加粗边框表示，并发一般无需特殊表示。具体如下图所示。

![image-20200719201731217](http://can.sfhfpc.com/uPic/image-20200719201731217.png)

协作图真的很简单，这里就不再举更多的案例进行说明和引导了，大家自行操作，动手实践几分钟就掌握了。